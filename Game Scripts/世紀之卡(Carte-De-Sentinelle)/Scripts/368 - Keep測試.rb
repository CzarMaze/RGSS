#encoding:utf-8
#==============================================================================
# ■ Lctseng::Game_StandController
#------------------------------------------------------------------------------
# 　控制立繪物件
#==============================================================================

module Lctseng
class Game_StandController
  #--------------------------------------------------------------------------
  # ● 保留立繪資訊
  #--------------------------------------------------------------------------
  def keep_stand_info
    puts "要求保留"
    @left.keep_info
    @right.keep_info
  end
end
end

#encoding:utf-8
#==============================================================================
# ■ Lctseng::Game_Stand
#------------------------------------------------------------------------------
# 　立繪物件
#==============================================================================

module Lctseng
class Game_Stand
  #--------------------------------------------------------------------------
  # ● 定義實例變數
  #--------------------------------------------------------------------------
  attr_reader :keep
  #--------------------------------------------------------------------------
  # ● 初始化對象
  #--------------------------------------------------------------------------
  alias old_initialize initialize unless $@
  #--------------------------------------------------------------------------
  def initialize(*args,&block)
    old_initialize(*args,&block)
    @keep_name = nil
    @keep = false
  end
  #--------------------------------------------------------------------------
  # ● 保留立繪資訊
  #--------------------------------------------------------------------------
  def keep_info
    if !@filename.empty? && @status != :none
      puts "圖片：#{@filename}已保留"
      @keep = true
      @keep_name = @filename
    end
  end  
  #--------------------------------------------------------------------------
  # ● 恢復立繪
  #--------------------------------------------------------------------------
  def process_keep
    change(@keep_name,false)
    @keep_name = nil
    @keep = false
  end  
end
end
#encoding:utf-8
#==============================================================================
# ■ Lctseng::Spriteset_Stand
#------------------------------------------------------------------------------
#     處理立繪的精靈組
#     監視Game_StandController進行立繪處理
#==============================================================================
module Lctseng
class Spriteset_Stand
  #--------------------------------------------------------------------------
  # ● 終止
  #--------------------------------------------------------------------------
  def terminate(keep = true)
    puts "終止處理"
    if keep
      control.keep_stand_info
    else
      control.on_terminate
      if any_sprite_show?
        puts "要求終止前顯示"
        @terminating_count  = 35
      end
    end
  end
end
end

#==============================================================================
# ■ Lctseng::Sprite_Stand
#------------------------------------------------------------------------------
#     立繪精靈
#==============================================================================
module Lctseng
class Sprite_Stand < Sprite_Base
  #--------------------------------------------------------------------------
  # ● 檢查動作
  #--------------------------------------------------------------------------
  alias old_check_action check_action unless $@
  #--------------------------------------------------------------------------
  def check_action(*args,&block)
    if control.keep
      puts "發現保留需求"
      control.process_keep
      process_keep
    else
      old_check_action(*args,&block)
    end
  end
  #--------------------------------------------------------------------------
  # ● 處理保留
  #--------------------------------------------------------------------------
  def process_keep
  end
  
end
end


